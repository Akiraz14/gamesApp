import{a as ct,b as Q,c as N,d as D,e as O,f as U,g as lt,h as $,j as ut,k as mt,l as H,m as dt,n as j,o as ft,p as pt,q as vt,r as ht,s as G,t as yt,u as _t,v as gt,w as Tt}from"./chunk-UIT5EF4V.js";import{Bb as F,Ca as P,Da as tt,Fb as at,Hb as st,Ia as y,Ib as k,Ja as et,Jb as A,Ka as c,L as Y,Na as s,O as I,Oa as a,Pa as _,Qa as E,Sa as d,Ta as m,U as x,Ua as it,Va as l,Wa as f,X as w,Xa as b,Ya as S,Za as rt,a as J,aa as v,ba as h,bb as T,cb as nt,d as Et,m as K,q as W,vb as ot,wa as Z,wb as V,xa as g,xb as M,y as X,za as n}from"./chunk-OBIQKGAT.js";var B=(()=>{let r=class r{constructor(){this.http=x(at),this.apiUrl=yt.triviaApiUrl,this._currentTrivia=[],this._currentAnswers=[]}generateQuestionary(t){let e=`${this.apiUrl}/questions?limit=${t.limit}`;return e+=t.categories?`&categories=${t.categories}`:"",e+=t.difficulties?`&difficulties=${t.difficulties}`:"",this.http.get(e).pipe(Y(u=>this._currentTrivia=u),W(()=>!0),X(u=>(console.error(u),K(!1))))}getQuestionary(){if(this._currentAnswers=[],this._currentTrivia.length===0)return[];let t=e=>e.sort(()=>Math.random()-.5);return this._currentTrivia.map(e=>({id:e.id,category:e.category,question:e.question.text,difficulty:e.difficulty,possibleAnswers:t([...e.incorrectAnswers,e.correctAnswer])}))}evaluateQuestionary(t){let e={isCorrect:!1,totalAnswers:t.length,totalMistakes:0};return t.forEach(u=>{let C=this._currentTrivia.find(p=>p.id===u.id);C&&(this._currentAnswers.push(J({isCorrect:C?.correctAnswer===u.answer},u)),e.totalMistakes+=C?.correctAnswer===u.answer?0:1)}),e.isCorrect=e.totalMistakes===0,e}getEvaluation(){return[...this._currentAnswers]}};r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var z=function(i){return i.music="music",i.sport_and_leisure="sport_and_leisure",i.film_and_tv="film_and_tv",i.arts_and_literature="arts_and_literature",i.history="history",i.society_and_culture="society_and_culture",i.science="science",i.geography="geography",i.food_and_drink="food_and_drink",i.general_knowledge="general_knowledge",i}(z||{}),q=function(i){return i.easy="easy",i.hard="hard",i.medium="medium",i}(q||{});var xt=(()=>{let r=class r{constructor(){this.difficultyValidator=()=>t=>!t.get("difficultyEasy")?.value&&!t.get("difficultyMedium")?.value&&!t.get("difficultyHard")?.value&&!t.get("difficultyAll")?.value?{missingDifficulty:!0}:null}};r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();function kt(i,r){if(i&1&&(s(0,"option",25),l(1),a()),i&2){let o=r.$implicit,t=m().$implicit;c("value",o),n(),b(" ",t("trivia.categories."+o)," ")}}function At(i,r){if(i&1){let o=E();s(0,"div",1)(1,"form",2),d("ngSubmit",function(){v(o);let e=m();return h(e.onSubmit())}),s(2,"div",3)(3,"label",4),l(4),a(),s(5,"select",5)(6,"option",6),l(7),a(),y(8,kt,2,2,"option",7),a()(),s(9,"div",8)(10,"label",9),l(11),a(),s(12,"div",10)(13,"input",11),d("change",function(){v(o);let e=m();return h(e.changeDifficulty("easy"))}),a(),s(14,"label",12),l(15),a()(),s(16,"div",10)(17,"input",13),d("change",function(){v(o);let e=m();return h(e.changeDifficulty("medium"))}),a(),s(18,"label",14),l(19),a()(),s(20,"div",10)(21,"input",15),d("change",function(){v(o);let e=m();return h(e.changeDifficulty("hard"))}),a(),s(22,"label",16),l(23),a()(),_(24,"hr"),s(25,"div",10)(26,"input",17),d("change",function(){v(o);let e=m();return h(e.selectAllDifficulties())}),a(),s(27,"label",18),l(28),a()()(),s(29,"div",3)(30,"div",19)(31,"div",3)(32,"label",20),l(33),a(),s(34,"input",21,22),d("change",function(){v(o);let e=it(35),u=m();return h(u.changeQuestionsNumber(e.valueAsNumber))}),a()()()(),s(36,"div",3)(37,"button",23),l(38),a()()(),_(39,"shared-loader-spinner",24),a()}if(i&2){let o=r.$implicit,t=m();n(),c("formGroup",t.triviaForm),n(3),b(" ",o("trivia.category")," "),n(3),b(" ",o("trivia.categories.all")," "),n(),c("ngForOf",t.categories),n(3),f(o("trivia.difficulty")),n(2),c("checked",t.difficultyEasy())("value",t.difficultyEasy()),n(2),f(o("trivia.difficulties.easy")),n(2),c("checked",t.difficultyMedium())("value",t.difficultyMedium()),n(2),f(o("trivia.difficulties.medium")),n(2),c("checked",t.difficultyHard())("value",t.difficultyHard()),n(2),f(o("trivia.difficulties.hard")),n(3),c("checked",t.difficultyAll())("value",t.difficultyAll()),n(2),f(o("trivia.difficulties.all")),n(5),S("",o("trivia.questionsNumber"),": ",t.currQuestionNum(),""),n(),c("min",t.minQuestions)("max",t.maxQuestions),n(3),c("disabled",t.triviaForm.invalid),n(),f(o("trivia.create")),n(),c("isVisible",t.isCreating())}}var St=(()=>{let r=class r{constructor(){this.fb=x(ht),this.triviaService=x(B),this.triviaValidator=x(xt),this.isCreatedEvent=new tt,this.minQuestions=5,this.maxQuestions=50,this.categories=Object.values(z),this.triviaForm=this.fb.group({category:[""],difficulties:this.fb.group({difficultyAll:[!1],difficultyEasy:[!1],difficultyMedium:[!0],difficultyHard:[!1]},{validators:this.triviaValidator.difficultyValidator()}),questionsNumber:[10,[N.required,N.min(this.minQuestions),N.max(this.maxQuestions)]]}),this.difficultyEasy=g(!1),this.difficultyMedium=g(!0),this.difficultyHard=g(!1),this.difficultyAll=Z(()=>this.difficultyEasy()&&this.difficultyMedium()&&this.difficultyHard()),this.difficultiesEffect=P(()=>{this.difficultyAll()||this.triviaForm.get("difficulties.difficultyAll")?.reset(!1)}),this.currQuestionNum=g(10),this.isCreating=g(!1)}changeDifficulty(t){switch(t){case q.easy:return this.difficultyEasy.update(e=>!e);case q.medium:return this.difficultyMedium.update(e=>!e);case q.hard:return this.difficultyHard.update(e=>!e)}}selectAllDifficulties(){let t=!this.difficultyAll();this.triviaForm.get("difficulties.difficultyAll")?.reset(t),this.difficultyEasy.set(t),this.triviaForm.get("difficulties.difficultyEasy")?.reset(t),this.difficultyMedium.set(t),this.triviaForm.get("difficulties.difficultyMedium")?.reset(t),this.difficultyHard.set(t),this.triviaForm.get("difficulties.difficultyHard")?.reset(t)}changeQuestionsNumber(t){this.currQuestionNum.set(t)}onSubmit(){if(this.isCreatedEvent.emit(!1),this.triviaForm.invalid)return;let t={limit:this.triviaForm.value.questionsNumber};if(this.triviaForm.value.category.length>0&&(t.categories=this.triviaForm.value.category),!this.triviaForm.value.difficulties.difficultyAll){let e=this.triviaForm.value.difficulties.difficultyEasy,u=this.triviaForm.value.difficulties.difficultyMedium,C=this.triviaForm.value.difficulties.difficultyHard,p="";p+=e?"easy,":"",p+=u?"medium,":"",p+=C?"hard,":"",p=p.slice(0,p.length-1),t.difficulties=p}this.isCreating.set(!0),this.triviaService.generateQuestionary(t).subscribe(e=>{this.isCreatedEvent.emit(e),this.isCreating.set(!1)})}};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=w({type:r,selectors:[["trivia-create"]],outputs:{isCreatedEvent:"isCreated"},standalone:!0,features:[T],decls:1,vars:1,consts:[["class","container",4,"transloco","translocoScope"],[1,"container"],[1,"row",3,"formGroup","ngSubmit"],[1,"col"],["for","category",1,"form-label"],["id","category","formControlName","category","aria-label","Select category",1,"form-select"],["value","","selected",""],[3,"value",4,"ngFor","ngForOf"],["formGroupName","difficulties",1,"col"],[1,"form-label"],[1,"form-check","form-switch"],["formControlName","difficultyEasy","type","checkbox","role","switch","id","difficultyEasy",1,"form-check-input",3,"checked","value","change"],["for","difficultyEasy",1,"form-check-label"],["formControlName","difficultyMedium","type","checkbox","role","switch","id","difficultyMedium",1,"form-check-input",3,"checked","value","change"],["for","difficultyMedium",1,"form-check-label"],["formControlName","difficultyHard","type","checkbox","role","switch","id","difficultyHard",1,"form-check-input",3,"checked","value","change"],["for","difficultyHard",1,"form-check-label"],["formControlName","difficultyAll","type","checkbox","role","switch","id","difficultyAll",1,"form-check-input",3,"checked","value","change"],["for","difficultyAll",1,"form-check-label"],[1,"row"],["for","questionsNumber",1,"form-label"],["type","range","formControlName","questionsNumber","id","questionsNumber",1,"form-range",3,"min","max","change"],["qNumber",""],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"isVisible"],[3,"value"]],template:function(e,u){e&1&&y(0,At,40,24,"div",0),e&2&&c("translocoScope","trivia")},dependencies:[F,V,G,$,pt,vt,Q,mt,ct,ft,D,O,H,j,dt,_t,A,k]});let i=r;return i})();var L=Et(Tt());function Nt(i,r){if(i&1&&(s(0,"div",12)(1,"p",13),l(2),a(),s(3,"p",13),l(4),a(),s(5,"p",13),l(6),a()()),i&2){let o=m().$implicit,t=m();n(2),S("",o("trivia.answers"),": ",t.result.totalAnswers,""),n(2),S("",o("trivia.mistakes"),": ",t.result.totalMistakes,""),n(2),S("",o("trivia.result"),": ",o("trivia.status."+t.result.isCorrect),"")}}function qt(i,r){if(i&1&&(s(0,"div",20),_(1,"input",21),s(2,"label",22),l(3),a()()),i&2){let o=r.$implicit,t=r.index,e=m().index;n(),c("id","Q"+e+"A"+t)("formControlName","Q"+e)("value",o),n(),c("for","Q"+e+"A"+t),n(),b(" ",o," ")}}function It(i,r){if(i&1&&(s(0,"div",14)(1,"h2",15)(2,"button",16),l(3),a()(),s(4,"div",17)(5,"div",18)(6,"h3"),l(7),a(),y(8,qt,4,5,"div",19),a()()()),i&2){let o=r.$implicit,t=r.index,e=m().$implicit;n(2),et("data-bs-target","#Q"+t)("aria-controls","Q"+t),n(),b(" ",e("trivia.question")+" #"+(t+1)," "),n(),c("id","Q"+t),n(3),f(o.question),n(),c("ngForOf",o.possibleAnswers)}}function Vt(i,r){if(i&1){let o=E();s(0,"div")(1,"form",1),d("ngSubmit",function(){v(o);let e=m();return h(e.onSubmit())}),s(2,"div",2)(3,"div",3),l(4," Trivia "),_(5,"shared-timer",4),a(),s(6,"div",5)(7,"div",6)(8,"p",7),l(9),a(),s(10,"p",7),l(11),a(),s(12,"button",8),l(13),a()(),y(14,Nt,7,6,"div",9),a()(),s(15,"div",10),y(16,It,9,6,"div",11),a()()()}if(i&2){let o=r.$implicit,t=m();n(),c("formGroup",t.questionForm),n(4),c("activate",t.activeTimer),n(4),rt("",o("trivia.questionsNumber"),": ",t.getAnswersCount()," / ",t.questionary.length,""),n(2),S("",o("trivia.attempts"),": ",t.attempts()," / 3"),n(),c("disabled",t.questionForm.invalid||t.questionForm.disabled),n(),b(" ",o("trivia.evaluate")," "),n(),c("ngIf",t.result),n(2),c("ngForOf",t.questionary)}}var wt=(()=>{let r=class r{constructor(){this.translocoService=x(st),this.triviaService=x(B),this.questionForm=new U({}),this.questionary=[],this.attempts=g(0),this.activeTimer=!1}ngOnInit(){this.questionary=this.triviaService.getQuestionary(),this.createQuestionaryForm()}ngOnDestroy(){this.pauseTimer()}startTimer(){this.activeTimer=!0}pauseTimer(){this.activeTimer=!1}createQuestionaryForm(){this.questionForm=new U({}),this.questionary.length!==0&&(this.questionary.forEach((t,e)=>{this.questionForm?.addControl(`Q${e}`,new lt("",N.required))}),this.startTimer())}getCurrentAnswers(){let t=[];return this.questionary.forEach((e,u)=>{t.push({id:e.id,answer:this.questionForm.get(`Q${u}`)?.value})}),t}getAnswersCount(){let t=0;return this.questionary.forEach((e,u)=>{this.questionForm.get(`Q${u}`)?.pristine||(t+=1)}),t}onSubmit(){this.questionForm.invalid||(this.pauseTimer(),L.default.fire({title:this.translocoService.translate("trivia.messageConfirm.title"),text:this.attempts()<2?this.translocoService.translate("trivia.messageConfirm.text",{remainingAttempts:3-this.attempts()}):this.translocoService.translate("trivia.messageConfirm.textLast"),icon:"question",confirmButtonColor:"#3085d6",confirmButtonText:this.translocoService.translate("trivia.messageConfirm.accept"),showCancelButton:!0,cancelButtonColor:"#d33",cancelButtonText:this.translocoService.translate("trivia.messageConfirm.cancel")}).then(t=>{if(!t.isConfirmed)this.startTimer();else{let e=this.getCurrentAnswers();this.attempts.update(C=>C+1);let u=this.triviaService.evaluateQuestionary([...e]);this.attempts()===3&&this.questionForm.setErrors({outOfAttempts:!0}),this.showEvaluationResult(u)}}))}showEvaluationResult(t){this.result=t,L.default.fire(t.isCorrect?{title:this.translocoService.translate("trivia.messageCorrect.title"),text:this.translocoService.translate("trivia.messageCorrect.text"),icon:"success"}:{title:this.translocoService.translate("trivia.messageIncorrect.title"),text:this.translocoService.translate("trivia.messageIncorrect.text"),icon:"error"}).then(()=>{!t.isCorrect&&this.attempts()<3?this.startTimer():t.isCorrect&&this.questionForm.disable()})}};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=w({type:r,selectors:[["trivia-questionary"]],standalone:!0,features:[T],decls:1,vars:1,consts:[[4,"transloco","translocoScope"],[3,"formGroup","ngSubmit"],[1,"card","mb-3","sticky","shadow"],[1,"card-header","text-bg-warning","d-flex","justify-content-between"],[3,"activate"],[1,"card-body"],[1,"col","d-flex","justify-content-between"],[1,"card-text"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","col d-flex justify-content-between mt-3",4,"ngIf"],["id","questionary",1,"accordion"],["class","accordion-item",4,"ngFor","ngForOf"],[1,"col","d-flex","justify-content-between","mt-3"],[1,"card-text","mb-0"],[1,"accordion-item"],[1,"accordion-header"],["type","button","data-bs-toggle","collapse","aria-expanded","true",1,"accordion-button"],[1,"accordion-collapse","collapse","show",3,"id"],[1,"accordion-body"],["class","form-check",4,"ngFor","ngForOf"],[1,"form-check"],["type","radio",1,"form-check-input",3,"id","formControlName","value"],[1,"form-check-label",3,"for"]],template:function(e,u){e&1&&y(0,Vt,17,11,"div",0),e&2&&c("translocoScope","trivia")},dependencies:[F,V,M,G,$,Q,ut,D,O,H,j,gt,A,k],styles:[".sticky[_ngcontent-%COMP%]{position:sticky;top:80px;z-index:1}"]});let i=r;return i})();var Mt=i=>({"text-truncate":i});function Qt(i,r){if(i&1){let o=E();s(0,"div",3)(1,"h2",4),l(2),a(),_(3,"hr"),s(4,"div",5)(5,"button",6),d("click",function(){v(o);let e=m();return h(e.fullDescription=!e.fullDescription)}),l(6," Description "),a(),s(7,"p",7),l(8),a()()()}if(i&2){let o=r.$implicit,t=m();n(2),f(o("games.trivia.title")),n(5),c("ngClass",nt(3,Mt,!t.fullDescription)),n(),f(o("games.trivia.description"))}}function Dt(i,r){i&1&&_(0,"trivia-questionary")}var ge=(()=>{let r=class r{constructor(){this.isCreated=g(!1),this.fullDescription=!1}onCreatedTrivia(t){this.isCreated.set(t)}};r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=w({type:r,selectors:[["app-trivia"]],standalone:!0,features:[T],decls:5,vars:2,consts:[["class","",4,"transloco","translocoScope"],[3,"isCreated"],[4,"ngIf"],[1,""],[1,"fs-dokdo","text-center"],[1,"mx-3"],["type","button",1,"btn","btn-secondary","btn-sm","mb-3",3,"click"],[3,"ngClass"]],template:function(e,u){e&1&&(y(0,Qt,9,5,"div",0),_(1,"hr"),s(2,"trivia-create",1),d("isCreated",function(p){return u.onCreatedTrivia(p)}),a(),_(3,"hr"),y(4,Dt,1,0,"trivia-questionary",2)),e&2&&(c("translocoScope","games"),n(4),c("ngIf",u.isCreated()))},dependencies:[F,ot,M,St,wt,A,k],styles:["h2[_ngcontent-%COMP%]{font-size:calc(1.325rem + 3vw)}"]});let i=r;return i})();export{ge as TriviaComponent};
